FUNCTION CHECKFILE(NM$)
	LOCAL I,BF
	SHARED FileEntry$()
	IF INSTR(NM$,"*")=0 THEN
		ARRAY SCAN FileEntry$(),=NM$, TO I
		IF I=%FALSE THEN BF=%NoFile
	END IF
	CHECKFILE=BF
END FUNCTION
:
FUNCTION CHECKNAME(NM$)
	LOCAL BF
	POSDOT=INSTR(NM$,".")
	BadNM$="|\,<>?/:;'[]"+CHR$(34)
	IF TALLY(NM$, ANY BadNM$) OR POSDOT>9 THEN BF=%BadName
	CHECKNAME=BF
END FUNCTION
